# Fluid properties

We look up fluid properties from a tab file and we probably don't have to.

We've trained a neural network to predict fluid properties for different compositions and we probably don't have to do that either.

The neural network was trained on the tab files generated by Multiflash. The tab files are generated by calculating the properties using an equation of state. People publish their equations of state.

::: {.callout-note}
This below sections are largely just highlights from papers. 
:::

## CPA

The [CPA equation of state](https://www.sciencedirect.com/science/article/abs/pii/S0378381213003920) presented by Kontogeorgis et al. [19], [20] combines the physical term from the cubic Soave–Redlich–Kwong (SRK) EoS with an association term similar to that found in the statistical associating fluid theory (SAFT) models.

### Pressure explicit form

On pressure explicit form, the CPA EoS [may be expressed](https://backend.orbit.dtu.dk/ws/portalfiles/portal/105170143/Peter_J_rgensen_Herslund_978_87_93054_54_7.pdf):

$$
P = \frac{R \cdot T}{V_m - b} - \frac{\alpha(T)}{V_m \cdot (V_m + b)} - \frac{R \cdot T}{2 \cdot V_m} \\ \cdot \left[ 1 + \frac{1}{V_m} \cdot \frac{\partial \ln g}{\partial (1/V_m)} \right] \times \sum_i x_i \sum_{A_i} (1 - X_{A_i})
$${#eq-cpa}

where $R$ is the gas constant and $T$ is temperature. $V_m$ denotes the molar volume, $\alpha(T)$ is the temperature dependent SRK energy parameter and $b$ is the SRK co-volume parameter. $g$ is the hard sphere radial distribution function. $A_i$ denotes association site A on component $i$. $x_i$ is the mole fraction of component $i$, $X_{A_i}$ is the fraction of sites, type $A$ on component $i$ not bonded to other sites. CPA simplifies to the SRK EoS for non-associating systems.

The fraction of non-bonded sites, $X_{A_i}$ is estimated by solving @eq-xai and @eq-association-strength.

$$
X_{A_i} = \left[ 1 + V_m ^{-1} \cdot \sum_j x_j \sum_{B_j} X_{B_j} \cdot \Delta^{A_iB_j} \right]
$${#eq-xai}

@eq-xai is evaluated for all site types on all associating components. The summation over $B_j$ in @eq-xai indicates summation over all association sites.  
$\Delta^{A_iB_j}$ is the association strength between site A on molecule $i$ and site B on molecule $j$. It is given by

$$
\Delta^{A_iB_j} = g(V_m)^{ref} \cdot [\exp(\epsilon^{A_iB_j} \cdot (R \cdot T)^{-1}) - 1] \cdot b_{ij} \cdot \beta^{A_iB_j}
$${#eq-association-strength}

$\epsilon^{A_iB_j}$ and $\beta^{A_iB_j}$ are the association energy and volume, respectively between site A on molecule $i$ and site B on molecule $j$. $g(V_m)^{ref}$ is the contact value of the radial distribution function for the reference hard sphere fluid system was presented in a simplified form by Kontogeorgis et al. (sCPA [21]). Whereas earlier versions of CPA utilised the Carnahan–Starling expression for the hard-sphere radial distribution function, sCPA uses the expression
shown in @eq-radial-distribution for the simplified hard-sphere radial distribution function.

$$
g(V_m) = \left[1 - 1.9 \cdot b \cdot (4 \cdot V_m)^{-1}\right]^{-1}
$${#eq-radial-distribution}

The temperature-dependent energy parameter, $\alpha_i(T)$ for pure component $i$, in the SRK term is calculated by means of @eq-tempdep-energy.

$$
\alpha_i(T) = a_{0,i} \cdot \left[ 1 + c_{1,i} \cdot \left( 1 - \sqrt{T \cdot T_{c,i}^{-1}} \right) \right]^2
$${#eq-tempdep-energy}

where $a_{0,i}$ and $c_{1,i}$ are pure component parameters and T_{c,i} is the critical temperature for component $i$. For associating components, the CPA EoS utilises five pure component parameters, $a_{0,i}$, $b_i$, $c_{1,i}$, $\epsilon^{A_iB_i}$ and $\beta^{A_iB_i}$. Non-associating components are described by three pure component parameters, $a_{0,i}$, $b_i$, $c_{1,i}$, in a manner similar to that of the "standard" SRK EoS. Pure component parameters for associating components are obtained by fitting the model to experimental vapour pressures and saturated liquid densities of the pure component. The three pure component parameters for non-associating compounds may also be obtained from critical temperature, $T_{c,i}$, critical pressure, $P_{c,i}$, and the acentric factor $\omega_i$.  
In binary systems, the van der Waals one-fluid mixing rules are used for evaluating the SRK parameters, $\alpha(T)$ and $b$. This is done according to @eq-binarysystem-alpha.

$$
\alpha(T) = \sum_i \sum_j x_i \cdot x_j \cdot \alpha_{ij}(T)
$${#eq-binarysystem-alpha}

$$
b = \sum_i x_i \cdot b_i
$${#eq-binarysystem-b}

where the "classical" combining rules are applied for the binary $\alpha_{ij}(T)$ in the SRK term and the binary $b_{ij}$ in the association term.

$$
\alpha_{ij}(T) = \sqrt{\alpha_i(T) \cdot \alpha_j(T)} \cdot (1 - k_{ij})
$${#eq-binary-aij}

$$
b_{ij} = (b_i + b_j) \cdot 2^{-1}
$${#eq-binary-bij}

$k_{ij}$ in @eq-binary-aij is the binary interaction parameter (BIP) between component $i$ and component $j$. $k_{ij}$ may be temperature-dependent, e.g. according to the equation $k_{ij} = a_{kij} + b_{kij} / T$. No mixing rules are needed for the association parameters for CPA. Only for cross associating systems, combining rules must be applied to the two association parameters $\epsilon^{A_iB_j}$ and $\beta^{A_iB_j}$.

### Combining rules

$$
\epsilon^{A_iB_j} = (\epsilon^{A_iB_i} + \epsilon^{A_jB_j}) \cdot 2^{-1}
$${#eq-combine-epsilon}

$$
\beta^{A_iB_j} = \sqrt{\beta^{A_iB_i} \cdot \beta^{A_jB_j}} + \gamma^{A_iB_j}
$${#eq-combine-beta}

The combining rule for $\beta^{A_iB_j}$, @eq-combine-beta, has been written in a general form, which handles both cross-association between two self-associating molecules as well as cross-association between one self-associating and one non self-associating molecule (solvation). In the case of cross-association between two self-associating molecules, $\gamma^{A_iB_j}$ may either be set to zero, in order to allow model prediction according to the standard CR1 combining rule, or it can be used as a handle on the deviation of the cross association interactions from the arithmetic mean. In cases with cross-association involving one non self-associating molecule, $\gamma^{A_iB_j}$ is needed to provide cross association interactions. For systems containing three or more components sCPA becomes predictive, since only binary interactions may be accounted for (directly) in the process of parameter estimation.


#### Parameters

:::{layout-ncol=2}
![Associating component parameters (conventional)](assets/img/cpa/cpa-params-assoc.png)

![Inert component parameters (conventional)](assets/img/cpa/cpa-params-inert.png)
:::
>Using eqs A.3 and the CPA parameters (a0, bCPA, c1), the “corresponding monomer” parameters can be calculated. This implies that we only need to use the three conventional EoS parameters: the (monomer) critical temperature, pressure, and m-parameters. These parameters are listed in Tables A1 and A2, for associating and inert compounds, respectively. For comparison, the experimental critical temperatures used in CPA are also provided in each table.


![Associating component parameters (CPA)](assets/img/cpa/cpa-bips-table4.png)

![3B Alcohol parameters (CPA)](assets/img/cpa/cpa-bips-table6.png)

![Correlated binary parameters (CPA)](assets/img/cpa/cpa2-bips-table4.png)


