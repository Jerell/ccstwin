# Solving {#sec-solving}

Our model will tell you the state of the network if you enter a solvable set of inputs. But if you only get answers when you enter values that produce a known output then you don't gain anything by running the model.

If you enter an invalid set of inputs, then our output (the final state of the search) is where the model gave up looking for an answer, not what happens when you enter those inputs.

## Wells and perforations

The analogue functions are designed to imitate the behaviour of wells and perforations by taking data about their inputs and outputs and fitting a curve to those data points. We trust the functions to cover the range we were provided data for, but nothing beyond that.

The data points are all from previous flow assurance cases, so they cover the expected operating range, but we have little if any data points for the extremes of our input space. Our search algorithms are not constrained to only cover the expected operating range.

## Splitters

The flowrate search in the splitter relies on the assumption that the relationship between the flowrate in a branch and the outlet pressure is injective. If any two flowrates produce the same outlet pressure then we can't use a binary search to explore the range of outputs.

By testing a range of flowrates for a particular branch, we found a case where the outlet pressure at 2 kgps was higher than both 1 kgps and 3 kgps. This may be extremely low, but it's within our domain so it's a number our search could potentially settle on.


## Inlet pressure search

This also relies on the assumption that the relationship between the input and output is injective. It's the same kind of search, but just changing a different variable. It's possible that a higher inlet pressure does always produce a higher outlet pressure but nobody has demonstrated that.

## Discontinuity points

| | Pressure | Temperature | Flowrate |
| - | - | - | - |
| Inlet | Unknown | Depends^[We can determine inlet temperature as a function of pressure] | Known |
| Valve | Unknown | Known | Known |
| Compressor | Depends^[Compressors are not well defined] | Unknown | Known |
| Splitter | Known | Known | Unknown |
| Heater | Known | Depends^[Increase by or to a value?] | Known |
| Cooler | Known | Depends | Known |

: Components where discontinuities occur {#tbl-discontinuities}

At an inlet, we want to know if there are any solutions with a fluid pressure below our maximum. At a valve, we ask "are there valid solutions with a fluid pressure above X at this point?" Depending on how compressors, heaters, and coolers are defined, we might ask whether a pressure/temperature increase to or by a certain amount at this point produces a valid solution.

You can produce direct answers to these with a good pipe segment model. If you were to change the set point of a valve, you wouldn't need to run all your simulations for the entire network again.

It seems like everything you would want to know about the component specific properties of these is external to the network snapshot. If you want to inspect the power consumption of a compressor train, that can be done by processing the results of a simulation, but it doesn't actually affect the results. It's just a way of formatting the output.

## Stability and robustness

By running snapshots we can see if our inputs produce a valid output. Not much else. We can't see the boundaries of our input space that separate the valid inputs from the invalid ones. We can't identify what region of our input space is the most stable unless we manually explore it. We don't know if increasing the reservoir pressure between snapshots will move our region of valid inputs such that the next solution we settle on from our binary search is on the other side of the region - a point could exist within both regions, again, we'd have to manually explore to find it. We don't know if our valid region is convex or concave. It's definitely not a single point, given that there are tolerances on the end pressures. We don't know if there's only one region. We don't know if there's even one region.

All we can say is that a path exists from A to B but we can't say how wide it is or how long it'll last.